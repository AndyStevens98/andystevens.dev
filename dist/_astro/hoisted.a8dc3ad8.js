const h=document.querySelector("body"),L=document.querySelectorAll(".modal");let m,g;const S=e=>{e.remove(),h.appendChild(e)},M=e=>[...e.querySelectorAll('a, button, input, textarea, select, details,[tabindex]:not([tabindex="-1"])')].filter(t=>!t.hasAttribute("disabled")),x=(e,t)=>{const o=M(t),s=o[0],n=o[o.length-1];document.activeElement===n&&e.key==="Tab"&&!e.shiftKey&&(e.preventDefault(),s.focus()),document.activeElement===s&&e.key==="Tab"&&e.shiftKey&&(e.preventDefault(),n.focus())},q=e=>{const t=e.querySelector("h3");e.classList.add("show"),h.classList.add("modal-is-active"),t.focus(),m=new AbortController,g=new AbortController,document.addEventListener("keydown",o=>x(o,e),{signal:m.signal}),e.addEventListener("keydown",o=>{o.key==="Escape"&&d()},{signal:g.signal})},d=e=>{L.forEach(t=>{t.classList.remove("show");const o=t.getAttribute("aria-labelledby");document.querySelector(`#${o}`).focus({preventScroll:!0}),m.abort(),g.abort()}),h.classList.remove("modal-is-active")};L.forEach(e=>{const t=e.getAttribute("aria-labelledby"),o=e.querySelector(".modal__close button");document.querySelector(`#${t}`).addEventListener("click",()=>q(e)),o.addEventListener("click",d),e.addEventListener("click",n=>{n.target.closest(".modal__content")||d()}),S(e)});window.closeModal=d;const l=document.querySelector("#main-navigation"),p=l.querySelector("ul"),u=[...document.querySelectorAll(".has-dropdown button")],D=()=>{const e=l.querySelectorAll("nav > ul"),t=window.location.pathname;e.forEach(o=>{[...o.querySelectorAll('a:not([rel*="external"])')].forEach(n=>{(t.includes(n.pathname.replaceAll("/",""))&&n.textContent!=="Home"||n.textContent==="Home"&&t==="/")&&(n.classList.add("is-active"),n.setAttribute("aria-current","page"))})})},k=()=>{const e=l.getBoundingClientRect().width,t=document.querySelector(".desktop-menu").getBoundingClientRect().width,o=300,s=parseInt(t)+o;s>=e?(l.classList.remove("is-desktop"),l.classList.add("is-mobile")):s<=e&&(l.classList.add("is-desktop"),l.classList.remove("is-mobile"))},C=e=>e.getBoundingClientRect().right>(window.innerWidth||document.documentElement.clientWidth),E=e=>{const t=e.parentNode.querySelector("ul");e.classList.add("show"),e.setAttribute("aria-expanded","true"),C(t)&&(t.style.left="auto")},w=e=>{e.classList.remove("show"),e.setAttribute("aria-expanded","false")},b=()=>{for(let e=0;e<u.length;e++)w(u[e])},T=e=>{e.target.getAttribute("aria-expanded")==="false"?(b(),E(e.target)):w(e.target)};p&&p.addEventListener("keydown",e=>{const t=e.target.closest("li"),o=[...p.querySelectorAll(".menu-item")],s=e.target.closest(".has-dropdown button"),n=e.target.closest(".has-dropdown li"),y=o.findIndex(c=>c===t),a=e.key;let r;if(a==="ArrowRight"&&(o.indexOf(t)===o.length-1?r=o[0]:r=o[y+1]),a==="ArrowLeft"&&(o.indexOf(t)===0?r=o[o.length-1]:r=o[y-1]),a==="Escape"&&(r=o[0]),s){const c=s.nextElementSibling.querySelector("li");a==="ArrowDown"&&(e.preventDefault(),E(s),r=c),a==="Escape"&&w(s)}if(n){const c=n.parentNode,i=[...c.querySelectorAll("li")],v=i.findIndex(A=>A===n);a==="ArrowDown"&&(e.preventDefault(),i.indexOf(n)===i.length-1?r=i[0]:r=i[v+1]),a==="ArrowUp"&&(e.preventDefault(),i.indexOf(n)===0?r=i[i.length-1]:r=i[v-1]),a==="Escape"&&(r=c.previousElementSibling.parentNode,b())}r&&r.querySelector("a, button, input").focus()});u&&u.forEach(e=>{e.addEventListener("click",T)});D();k();window.addEventListener("resize",k);window.addEventListener("click",e=>{!e.target.hasAttribute("aria-haspopup")&&!e.target.classList.contains("submenu-item")&&b()});const f=document.querySelector(".responsive-toggle"),I=e=>{e.setAttribute("aria-expanded",!0),e.setAttribute("aria-label","Close menu navigation"),e.innerHTML='<svg width="20" height="20" aria-hidden="true" fill="var(--action-color)" xmlns="http://www.w3.org/2000/svg"><path d="M10 10 2 2m8 8 8 8m-8-8 8-8m-8 8-8 8" stroke="var(--action-color)" stroke-width="2.667" stroke-linecap="round" stroke-linejoin="round"/></svg>'},B=e=>{e.setAttribute("aria-expanded",!1),e.setAttribute("aria-label","Open menu navigation"),e.innerHTML='<svg width="26" height="21" aria-hidden="true" fill="var(--action-color)" xmlns="http://www.w3.org/2000/svg"><path d="M2 1.667h24m-24 8h24m-24 8h24" stroke="var(--action-color)" stroke-width="2.667" stroke-linecap="round" stroke-linejoin="round"/></svg>'};f.addEventListener("click",e=>{const t=document.querySelector(".mobile-menu");t.classList.toggle("show"),t.classList.contains("show")?I(f):B(f)});
